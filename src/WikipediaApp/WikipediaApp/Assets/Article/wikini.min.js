function changeTheme(e){"theme-light"===e?(document.documentElement.classList.replace("theme-dark",e),document.body.classList.replace("theme-dark",e)):"theme-dark"===e&&(document.documentElement.classList.replace("theme-light",e),document.body.classList.replace("theme-light",e))}function registerEventListeners(){registerContextmenuEvents(),registerScrollEvents()}const sectionMargin=50;let timer,sections=[];function registerScrollEvents(){window.addEventListener("resize",(function(e){_refresh()})),window.addEventListener("scroll",(function(e){_updateScrollPosition(this.scrollX,this.scrollY)})),_updateSections(!0),_updateScrollPosition(window.scrollX,window.scrollY)}function scrollToTop(){document.body.scrollTop=0,document.documentElement.scrollTop=0}function scrollToSection(e){const t=document.getElementById(e);if(null!=t){let e=t.parentElement;for(;null!=e&&"SECTION"!==e.tagName;)e=e.parentElement;null==e||e.classList.contains("open-block")||(e.previousSibling.click(),_refresh()),_scrollToElement(t)}}function scrollToElement(e){const t=document.getElementById(e);null!=t&&_scrollToElement(t)}function _scrollToElement(e){const t=e.getBoundingClientRect(),n=document.body.style.marginTop.substring(0,document.body.style.marginTop.length-2);window.scrollTo(0,t.top+window.scrollY-20-n)}function _refresh(){_updateSections(!1),_updateScrollPosition(window.scrollX,window.scrollY)}function _updateSections(e){sections=[],document.querySelectorAll(".mw-headline").forEach((function(t){e&&t.parentElement.classList.contains("section-heading")&&t.parentElement.addEventListener("click",(function(e){clearTimeout(timer),timer=setTimeout(_refresh,150)}));const n=t.parentElement.offsetTop;n>0&&sections.push({id:t.id,top:n,element:t})}))}function _updateScrollPosition(e,t){const n=document.documentElement,s=n.scrollWidth-n.clientWidth,r=n.scrollHeight-n.clientHeight,o=sections.length-[...sections].reverse().findIndex(e=>t>=e.top-50)-1,i=o>=0&&o<sections.length?sections[o].id.replace(/'/g,"\\'"):"";window.external.notify(`{ 'Message': 'Scroll', 'X': ${e}, 'Y': ${t}, 'Width': ${s}, 'Height': ${r}, 'Text': '${i}' }`)}function registerContextmenuEvents(){document.oncontextmenu=function(e){e.preventDefault();const t=document.getSelection();if(t.containsNode(e.target,!0))_handleSelectionContextmenu(e,t);else{const t=e.target.closest("a");t?_handleLinkContextmenu(t):_handleContextmenu(e)}}}function _handleSelectionContextmenu(e,t){const n=e.clientX,s=e.clientY;window.external.notify(`{ 'Message': 'Contextmenu', 'X': ${n}, 'Y': ${s}, 'Text': '${t}' }`)}function _handleLinkContextmenu(e){const t=e.getBoundingClientRect(),n=t.left,s=t.top,r=t.right-n,o=t.bottom-s,i=e.href,a=e.title.replace(/'/g,"\\'");window.external.notify(`{ 'Message': 'Contextmenu', 'X': ${n}, 'Y': ${s}, 'Width': ${r}, 'Height': ${o}, 'Url': '${i}', 'Text': '${a}' }`)}function _handleContextmenu(e){const t=e.clientX,n=e.clientY;window.external.notify(`{ 'Message': 'Contextmenu', 'X': ${t}, 'Y': ${n} }`)}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Mark=t()}(this,(function(){"use strict";class e{constructor(e,t=!0,n=[],s=5e3){this.ctx=e,this.iframes=t,this.exclude=n,this.iframesTimeout=s}static matches(e,t){const n="string"==typeof t?[t]:t,s=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(s){let t=!1;return n.every(n=>!s.call(e,n)||(t=!0,!1)),t}return!1}getContexts(){let e,t=[];return(e=void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach(e=>{const n=t.filter(t=>t.contains(e)).length>0;-1!==t.indexOf(e)||n||t.push(e)}),t}getIframeContents(e,t,n=(()=>{})){let s;try{const t=e.contentWindow;if(s=t.document,!t||!s)throw new Error("iframe inaccessible")}catch(e){n()}s&&t(s)}isIframeBlank(e){const t="about:blank",n=e.getAttribute("src").trim();return e.contentWindow.location.href===t&&n!==t&&n}observeIframeLoad(e,t,n){let s=!1,r=null;const o=()=>{if(!s){s=!0,clearTimeout(r);try{this.isIframeBlank(e)||(e.removeEventListener("load",o),this.getIframeContents(e,t,n))}catch(e){n()}}};e.addEventListener("load",o),r=setTimeout(o,this.iframesTimeout)}onIframeReady(e,t,n){try{"complete"===e.contentWindow.document.readyState?this.isIframeBlank(e)?this.observeIframeLoad(e,t,n):this.getIframeContents(e,t,n):this.observeIframeLoad(e,t,n)}catch(e){n()}}waitForIframes(e,t){let n=0;this.forEachIframe(e,()=>!0,e=>{n++,this.waitForIframes(e.querySelector("html"),()=>{--n||t()})},e=>{e||t()})}forEachIframe(t,n,s,r=(()=>{})){let o=t.querySelectorAll("iframe"),i=o.length,a=0;o=Array.prototype.slice.call(o);const c=()=>{--i<=0&&r(a)};i||c(),o.forEach(t=>{e.matches(t,this.exclude)?c():this.onIframeReady(t,e=>{n(t)&&(a++,s(e)),c()},c)})}createIterator(e,t,n){return document.createNodeIterator(e,t,n,!1)}createInstanceOnIframe(t){return new e(t.querySelector("html"),this.iframes)}compareNodeIframe(e,t,n){if(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING){if(null===t)return!0;if(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}getIteratorNode(e){const t=e.previousNode();let n;return{prevNode:t,node:n=(null===t||e.nextNode())&&e.nextNode()}}checkIframeFilter(e,t,n,s){let r=!1,o=!1;return s.forEach((e,t)=>{e.val===n&&(r=t,o=e.handled)}),this.compareNodeIframe(e,t,n)?(!1!==r||o?!1===r||o||(s[r].handled=!0):s.push({val:n,handled:!0}),!0):(!1===r&&s.push({val:n,handled:!1}),!1)}handleOpenIframes(e,t,n,s){e.forEach(e=>{e.handled||this.getIframeContents(e.val,e=>{this.createInstanceOnIframe(e).forEachNode(t,n,s)})})}iterateThroughNodes(e,t,n,s,r){const o=this.createIterator(t,e,s);let i,a,c=[],l=[],h=()=>(({prevNode:a,node:i}=this.getIteratorNode(o)),i);for(;h();)this.iframes&&this.forEachIframe(t,e=>this.checkIframeFilter(i,a,e,c),t=>{this.createInstanceOnIframe(t).forEachNode(e,e=>l.push(e),s)}),l.push(i);l.forEach(e=>{n(e)}),this.iframes&&this.handleOpenIframes(c,e,n,s),r()}forEachNode(e,t,n,s=(()=>{})){const r=this.getContexts();let o=r.length;o||s(),r.forEach(r=>{const i=()=>{this.iterateThroughNodes(e,r,t,n,()=>{--o<=0&&s()})};this.iframes?this.waitForIframes(r,i):i()})}}class t{constructor(e){this.opt=Object.assign({},{diacritics:!0,synonyms:{},accuracy:"partially",caseSensitive:!1,ignoreJoiners:!1,ignorePunctuation:[],wildcards:"disabled"},e)}create(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e),new RegExp(e,"gm"+(this.opt.caseSensitive?"":"i"))}sortByLength(e){return e.sort((e,t)=>e.length===t.length?e>t?1:-1:t.length-e.length)}escapeStr(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}createSynonymsRegExp(e){const t=this.opt.synonyms,n=this.opt.caseSensitive?"":"i",s=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(let r in t)if(t.hasOwnProperty(r)){let o=Array.isArray(t[r])?t[r]:[t[r]];o.unshift(r),(o=this.sortByLength(o).map(e=>("disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),this.escapeStr(e))).filter(e=>""!==e)).length>1&&(e=e.replace(new RegExp(`(${o.map(e=>this.escapeStr(e)).join("|")})`,"gm"+n),s+`(${o.map(e=>this.processSynonyms(e)).join("|")})`+s))}return e}processSynonyms(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}setupWildcardsRegExp(e){return(e=e.replace(/(?:\\)*\?/g,e=>"\\"===e.charAt(0)?"?":"")).replace(/(?:\\)*\*/g,e=>"\\"===e.charAt(0)?"*":"")}createWildcardsRegExp(e){let t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}setupIgnoreJoinersRegExp(e){return e.replace(/[^(|)\\]/g,(e,t,n)=>{let s=n.charAt(t+1);return/[(|)\\]/.test(s)||""===s?e:e+"\0"})}createJoinersRegExp(e){let t=[];const n=this.opt.ignorePunctuation;return Array.isArray(n)&&n.length&&t.push(this.escapeStr(n.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join(`[${t.join("")}]*`):e}createDiacriticsRegExp(e){const t=this.opt.caseSensitive?"":"i",n=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"];let s=[];return e.split("").forEach(r=>{n.every(n=>{if(-1!==n.indexOf(r)){if(s.indexOf(n)>-1)return!1;e=e.replace(new RegExp(`[${n}]`,"gm"+t),`[${n}]`),s.push(n)}return!0})}),e}createMergedBlanksRegExp(e){return e.replace(/[\s]+/gim,"[\\s]+")}createAccuracyRegExp(e){let t=this.opt.accuracy,n="string"==typeof t?t:t.value,s="string"==typeof t?[]:t.limiters,r="";switch(s.forEach(e=>{r+="|"+this.escapeStr(e)}),n){case"partially":default:return`()(${e})`;case"complementary":return`()([^${r="\\s"+(r||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿"))}]*${e}[^${r}]*)`;case"exactly":return`(^|\\s${r})(${e})(?=$|\\s${r})`}}}class n{constructor(e){this.ctx=e,this.ie=!1;const t=window.navigator.userAgent;(t.indexOf("MSIE")>-1||t.indexOf("Trident")>-1)&&(this.ie=!0)}set opt(e){this._opt=Object.assign({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,acrossElements:!1,ignoreGroups:0,each:()=>{},noMatch:()=>{},filter:()=>!0,done:()=>{},debug:!1,log:window.console},e)}get opt(){return this._opt}get iterator(){return new e(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}log(e,t="debug"){const n=this.opt.log;this.opt.debug&&"object"==typeof n&&"function"==typeof n[t]&&n[t]("mark.js: "+e)}getSeparatedKeywords(e){let t=[];return e.forEach(e=>{this.opt.separateWordSearch?e.split(" ").forEach(e=>{e.trim()&&-1===t.indexOf(e)&&t.push(e)}):e.trim()&&-1===t.indexOf(e)&&t.push(e)}),{keywords:t.sort((e,t)=>t.length-e.length),length:t.length}}isNumeric(e){return Number(parseFloat(e))==e}checkRanges(e){if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];const t=[];let n=0;return e.sort((e,t)=>e.start-t.start).forEach(e=>{let{start:s,end:r,valid:o}=this.callNoMatchOnInvalidRanges(e,n);o&&(e.start=s,e.length=r-s,t.push(e),n=r)}),t}callNoMatchOnInvalidRanges(e,t){let n,s,r=!1;return e&&void 0!==e.start?(s=(n=parseInt(e.start,10))+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&s-t>0&&s-n>0?r=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(e)),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:n,end:s,valid:r}}checkWhitespaceRanges(e,t,n){let s,r=!0,o=n.length,i=t-o,a=parseInt(e.start,10)-i;return(s=(a=a>o?o:a)+parseInt(e.length,10))>o&&(s=o,this.log("End range automatically set to the max value of "+o)),a<0||s-a<0||a>o||s>o?(r=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):""===n.substring(a,s).replace(/\s+/g,"")&&(r=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:a,end:s,valid:r}}getTextNodes(e){let t="",n=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,e=>{n.push({start:t.length,end:(t+=e.textContent).length,node:e})},e=>this.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT,()=>{e({value:t,nodes:n})})}matchesExclude(t){return e.matches(t,this.opt.exclude.concat(["script","style","title","head","html"]))}wrapRangeInTextNode(e,t,n){const s=this.opt.element?this.opt.element:"mark",r=e.splitText(t),o=r.splitText(n-t);let i=document.createElement(s);return i.setAttribute("data-markjs","true"),this.opt.className&&i.setAttribute("class",this.opt.className),i.textContent=r.textContent,r.parentNode.replaceChild(i,r),o}wrapRangeInMappedTextNode(e,t,n,s,r){e.nodes.every((o,i)=>{const a=e.nodes[i+1];if(void 0===a||a.start>t){if(!s(o.node))return!1;const a=t-o.start,c=(n>o.end?o.end:n)-o.start,l=e.value.substr(0,o.start),h=e.value.substr(c+o.start);if(o.node=this.wrapRangeInTextNode(o.node,a,c),e.value=l+h,e.nodes.forEach((t,n)=>{n>=i&&(e.nodes[n].start>0&&n!==i&&(e.nodes[n].start-=c),e.nodes[n].end-=c)}),n-=c,r(o.node.previousSibling,o.start),!(n>o.end))return!1;t=o.end}return!0})}wrapGroups(e,t,n,s){return s((e=this.wrapRangeInTextNode(e,t,t+n)).previousSibling),e}separateGroups(e,t,n,s,r){let o=t.length;for(let n=1;n<o;n++){let o=e.textContent.indexOf(t[n]);t[n]&&o>-1&&s(t[n],e)&&(e=this.wrapGroups(e,o,t[n].length,r))}return e}wrapMatches(e,t,n,s,r){const o=0===t?0:t+1;this.getTextNodes(t=>{t.nodes.forEach(t=>{let r;for(t=t.node;null!==(r=e.exec(t.textContent))&&""!==r[o];){if(this.opt.separateGroups)t=this.separateGroups(t,r,o,n,s);else{if(!n(r[o],t))continue;let e=r.index;if(0!==o)for(let t=1;t<o;t++)e+=r[t].length;t=this.wrapGroups(t,e,r[o].length,s)}e.lastIndex=0}}),r()})}wrapMatchesAcrossElements(e,t,n,s,r){const o=0===t?0:t+1;this.getTextNodes(t=>{let i;for(;null!==(i=e.exec(t.value))&&""!==i[o];){let r=i.index;if(0!==o)for(let e=1;e<o;e++)r+=i[e].length;const a=r+i[o].length;this.wrapRangeInMappedTextNode(t,r,a,e=>n(i[o],e),(t,n)=>{e.lastIndex=n,s(t)})}r()})}wrapRangeFromIndex(e,t,n,s){this.getTextNodes(r=>{const o=r.value.length;e.forEach((e,s)=>{let{start:i,end:a,valid:c}=this.checkWhitespaceRanges(e,o,r.value);c&&this.wrapRangeInMappedTextNode(r,i,a,n=>t(n,e,r.value.substring(i,a),s),t=>{n(t,e)})}),s()})}unwrapMatches(e){const t=e.parentNode;let n=document.createDocumentFragment();for(;e.firstChild;)n.appendChild(e.removeChild(e.firstChild));t.replaceChild(n,e),this.ie?this.normalizeTextNode(t):t.normalize()}normalizeTextNode(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}markRegExp(e,t){this.opt=t,this.log(`Searching with expression "${e}"`);let n=0,s="wrapMatches";this.opt.acrossElements&&(s="wrapMatchesAcrossElements"),this[s](e,this.opt.ignoreGroups,(e,t)=>this.opt.filter(t,e,n),e=>{n++,this.opt.each(e)},()=>{0===n&&this.opt.noMatch(e),this.opt.done(n)})}mark(e,n){this.opt=n;let s=0,r="wrapMatches";const{keywords:o,length:i}=this.getSeparatedKeywords("string"==typeof e?[e]:e),a=e=>{const n=new t(this.opt).create(e);let c=0;this.log(`Searching with expression "${n}"`),this[r](n,1,(t,n)=>this.opt.filter(n,e,s,c),e=>{c++,s++,this.opt.each(e)},()=>{0===c&&this.opt.noMatch(e),o[i-1]===e?this.opt.done(s):a(o[o.indexOf(e)+1])})};this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),0===i?this.opt.done(s):a(o[0])}markRanges(e,t){this.opt=t;let n=0,s=this.checkRanges(e);s&&s.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(s)),this.wrapRangeFromIndex(s,(e,t,n,s)=>this.opt.filter(e,t,n,s),(e,t)=>{n++,this.opt.each(e,t)},()=>{this.opt.done(n)})):this.opt.done(n)}unmark(t){this.opt=t;let n=this.opt.element?this.opt.element:"*";n+="[data-markjs]",this.opt.className&&(n+="."+this.opt.className),this.log(`Removal selector "${n}"`),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,e=>{this.unwrapMatches(e)},t=>{const s=e.matches(t,n),r=this.matchesExclude(t);return!s||r?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}}return function(e){const t=new n(e);return this.mark=(e,n)=>(t.mark(e,n),this),this.markRegExp=(e,n)=>(t.markRegExp(e,n),this),this.markRanges=(e,n)=>(t.markRanges(e,n),this),this.unmark=e=>(t.unmark(e),this),this}}));let results=[],currentIndex=0,markInstance=null,content=null;function search(e){markInstance||(content=document.getElementById("content"),markInstance=new Mark(content)),markInstance.unmark({done:function(){markInstance.mark(e,{separateWordSearch:!1,acrossElements:!0,done:function(e){results=content.getElementsByTagName("mark"),currentIndex=0,_jumpTo(),window.external.notify(`{ 'Message': 'SearchResults', 'Number': ${e} }`)}})}})}function searchForward(){results.length&&(++currentIndex>=results.length&&(currentIndex=0),_jumpTo())}function searchBackward(){results.length&&(--currentIndex<0&&(currentIndex=results.length-1),_jumpTo())}function _jumpTo(){if(results.length){for(let e=0;e<results.length;e++)results[e].classList.remove("current");const e=results.item(currentIndex);e&&(e.classList.add("current"),_scrollIntoView(e))}}function _scrollIntoView(e){const t=e.getBoundingClientRect(),n=document.body.style.marginTop.substring(0,document.body.style.marginTop.length-2);t.bottom+50>window.innerHeight&&window.scrollBy(0,t.bottom-window.innerHeight+50),t.top<0&&window.scrollBy(0,t.top-n-20)}